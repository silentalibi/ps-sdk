<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<!--
/*
    Copyright 2022 Adobe
    Distributed under the MIT License (see accompanying file LICENSE_1_0_0.txt
    or a copy at http://opensource.adobe.com/licenses.html)
*/
Some files are held under additional license. Please see "licenses.html" for more information.
-->

<head>
    <TITLE>Adobe Photoshop SDK: Scripting Plug-ins</TITLE>
    <META HTTP-EQUIV="content-type" CONTENT="text/html;charset=ISO-8859-1"/>
    <LINK TYPE="text/css" REL="stylesheet" HREF="basic.css"/>
    <STYLE TYPE="text/css" MEDIA="all"><!--
        @import url("modern.css");
    --></STYLE>
    <LINK TYPE="text/css" REL="stylesheet" HREF="print.css" MEDIA="print"/>
    <LINK TYPE="text/css" REL="stylesheet" HREF="mainnav.css"/>
    <LINK TYPE="text/css" REL="stylesheet" HREF="stlab.css"/>
	<LINK TYPE="text/css" REL="stylesheet" HREF="adobetabs.css"/>
</HEAD>

<body bgcolor="white">

<div id="mainnav" width="100%">
<table width="100%" border="0"><tr><td width="50%">
<a title="Adobe Systems home page" href="http://www.adobe.com/" tabindex="2"><img src="./images/logo.gif" alt="Adobe Systems, Inc." height="80" width="150"/></a>
</td><td align="right" valign="top">
<a href="index.html" class="el" target="_top"><font size="+2" color="black">Adobe Photoshop SDK</font></a><br/>
</td></tr></table>

</div>
<br/>
<table border="0" cellspacing="0" cellpadding="0" width="100%">
<tr><td width="10" nowrap="1"> </td>
<td valign="top">
    <table border="0" bgcolor=#ededed cellpadding="5">
    <tr><td nowrap="1">
        <h3 class="navbar">Getting Started</h3>
        <ul>
            <li><a href="programmersguideintro.html">Home</a></li>
            <li><a href="index.html">New for 2024</a></li>
	        <li><a href="arm.html">Project settings for ARM</a></li>
            <li><a href="bigsur.html">Debugging on Big Sur</a></li>
	        <li><a href="notarize.html">Notarize plug-ins for Macintosh</a></li>
	        <li><a href="hardenedruntime.html">Hardened Runtime plug-ins for Macintosh</a></li>
            <li><a href="faqs.html">Frequently Asked Questions</a></li>
            <li><a href="tutorialsexamples.html">Tutorials and Examples</a></li>
			<li><a href="developerresources.html">Developer Resources</a></li>
        </ul>
        <h3 class="navbar">SDK API Reference</h3>
        <ul>
			<li><a href="annotated.html">Data Structure List</a></li>
		    <li><a href="classes.html">Data Structure Index</a></li>
			<li><a href="functions.html">Member Index</a></li>
			<li><a href="files.html">File List</a></li>
		    <li><a href="globals.html">File Member Index</a></li>
        </ul>
        <h3 class="navbar">SDK API Features</h3>
        <ul>
            <li><a href="rgcallbacks.html">Callbacks</a></li>
			<li><a href="pluginmodules.html">Plug-in Modules</a></li>
		    <li><a href="memorymanagement.html">Memory Management</a></li>
			<li><a href="resourcemanagement.html">Resource Management</a></li>
			<li><a href="pixelmanagement.html">Pixel Management</a></li>
			<li><a href="colormanagement.html">Color Management</a></li>
			<li><a href="automation.html">Actions and Automation</a></li>
			<li><a href="filehandling.html">File Handling</a></li>
        </ul>
        <h3 class="navbar">Other Documentation</h3>
        <ul>
          <li><a href="programmersguidemain.html">SDK Programmer's Guide</a></li>
		      <li><a href="../PICA.pdf">Adobe PICA API</a>
        </ul>
    </td></tr>
    </table>
</td>

<td width="10" nowrap="1"> </td>
<td width="100%" valign="top">

<!-- End Header -->

<!-- Generated by Doxygen 1.4.7-20061004 -->
<h1><a class="anchor" name="PGScriptingPlugins">Scripting Plug-ins</a></h1><b>Sections on this Page</b><ul>
<li><a class="el" href="pgscriptingplugins.html#PGScriptingBasics">Scripting Basics</a><ul>
<li><a class="el" href="pgscriptingplugins.html#PGscriptingImplementationOrder">Implementation Order</a></li><li><a class="el" href="pgscriptingplugins.html#PGScriptingCaveats">Scripting Caveats</a></li></ul>
</li><li><a class="el" href="pgscriptingplugins.html#PGScriptingCreatingResource">Creating a Terminology Resource</a><ul>
<li><a class="el" href="pgscriptingplugins.html#PGScriptingBasicResource">Basic Terminology Resource Format</a></li><li><a class="el" href="pgscriptingplugins.html#PGSCriptingDetailedResource">Detailed Terminology Resource Example</a></li><li><a class="el" href="pgscriptingplugins.html#PGSCriptingNomenclature">Nomenclature</a></li><li><a class="el" href="pgscriptingplugins.html#PGScriptingParametersAndProperties">Parameters and Properties</a></li><li><a class="el" href="pgscriptingplugins.html#PGScriptingClasses">Classes and the Terminology Resource</a></li><li><a class="el" href="pgscriptingplugins.html#PGScriptingEnumeratedTypes">Enumerated Types</a></li><li><a class="el" href="pgscriptingplugins.html#PGScriptingLists">Lists and the Terminology Resource</a></li></ul>
</li><li><a class="el" href="pgscriptingplugins.html#PGscriptingDescriptor">Descriptors</a><ul>
<li><a class="el" href="pgscriptingplugins.html#PGScriptingFilterEvents">Filter, Selection, and Color Picker Events</a></li><li><a class="el" href="pgscriptingplugins.html#PGScriptingImportObjects">Import, Export, and Format Objects</a></li><li><a class="el" href="pgscriptingplugins.html#PGScriptingObjectRef">Type typeObjectReference</a></li></ul>
</li><li><a class="el" href="pgscriptingplugins.html#PGScriptingParameters">Scripting Parameters</a></li><li><a class="el" href="pgscriptingplugins.html#PGScriptingRecording">Recording</a><ul>
<li><a class="el" href="pgscriptingplugins.html#RecordingErrorHandling">Recording Error Handling</a></li><li><a class="el" href="pgscriptingplugins.html#RecordingClasses">Recording Classes</a></li></ul>
</li><li><a class="el" href="pgscriptingplugins.html#PGScriptingPlayback">Playback</a><ul>
<li><a class="el" href="pgscriptingplugins.html#PlaybackErrorHandling">Playback error handling</a></li></ul>
</li><li><a class="el" href="pgscriptingplugins.html#PGScriptingApplescriptCompatiblity">AppleScript Compatibility</a><ul>
<li><a class="el" href="pgscriptingplugins.html#PGScriptingRegistration">Registration and Unique Name Spaces</a></li><li><a class="el" href="pgscriptingplugins.html#PGScriptingIgnoringAppleScript">Ignoring AppleScript</a></li><li><a class="el" href="pgscriptingplugins.html#PGScriptingAppleEvents">AppleEvents</a></li></ul>
</li></ul>
<p>
Adobe Photoshop 4.0 introduced a new palette and subsequent set of commands and callbacks: the <em>Actions</em> palette, and the <em>Descriptor</em> callback suite. The Actions palette is the user-interface and hub for the scripting system for Adobe Photoshop. Adobe Photoshop 5.0 extends the Actions structure to include automation plug-ins that can access all scriptable Photoshop commands.<p>
Actions allow commands in Photoshop to be recorded in a form that is easy for an end user to read and edit. Actions are similar to AppleScript and AppleEvents but are cross platform and designed to support both AppleScript on the Macintosh and OLE Automation on Windows.<p>
Actions extend the plug-in API to allow Import, Export, Filter, Format and Selection plug-in modules to be fully recordable and automated.<p>
<b>Scripting on Windows with OLE</b> <br>
 While the scripting system operates consistently across both Windows and Macintosh platforms, in Photoshop 4.0 and 5.0, additional OLE automation has been added. See <a href="../Photoshop OLE Automation.pdf">OLE Automation Programming Guide</a>.<p>
<b>AppleScript and AppleEvents recommended reading</b> <br>
 Since Actions are based on AppleScript and AppleEvents, we recommend the following materials for preliminary reading:<ul>
<li>Inside Macintosh: Interapplication Communication (Addison-Wesley, 1993);</li><li>"Apple Event Objects and You" (Richard Clark, develop, issue 10);</li><li>"Better Apple Event Coding Through Objects" (Eric M. Berdahl, develop, issue 11);</li><li>"Designing Scriptability" (Cal Simone, develop, issue 21);</li><li>Series: "According to Script" (Cal Simone, develop, issues 22-25);</li></ul>
<p>
See <a href="http://www.mactech.com/articles/develop">MacTech develop Article Archives</a>.<p>
All the plug-in module examples that support scripting have been updated. Detailed code-related information is available in each separate module example and in <a class="el" href="_p_i_actions_8h.html">PIActions.h</a>.<p>
<b>Photoshop 5.0 Automation plug-ins</b> <br>
 See <a href="../Photoshop Actions Guide.pdf">Photoshop Actions Event Guide</a> for implementation details on Adobe Photoshop 5.0 Automation plug-in modules.<h2><a class="anchor" name="PGScriptingBasics">
Scripting Basics</a></h2>
For a plug-in to be scripting-aware, or able to record scripting parameters and be automated by them, it requires the addition of two basic mechanisms:<ul>
<li><b>Terminology resource.</b> A <em>terminology resource</em> maps the keys to human readable text, providing additional type information for values. For instance, key <code>keyLuminance</code> (<code>'Lmnc'</code>) and its value <code>typeInteger</code> may be mapped to the human readable text "luminance value". This is accompanied by the <code>HasTerminology</code> PiPL property, which points the scripting system to the terminology resource.</li><li><b>Descriptors</b>. A descriptor is a pair of data in the form of [&lt;<em>key&gt;</em> &lt;<em>value&gt;</em>] that describes the property of an object or the parameter of an event.</li></ul>
<h3><a class="anchor" name="PGscriptingImplementationOrder">
Implementation Order</a></h3>
We recommend you convert existing plug-ins to scripting-aware plug-ins by following this scripting implementation order:<ol type=1>
<li>Look at your user interfaces and describe the parameters as human-readable text;</li><li>Create a terminology resource for your plug-in;</li><li>Add the <code>HasTerminology</code> PiPL property;</li><li>Update your plug-in code to record scripting events and objects;</li><li>Update your plug-in code to be automated by (play back) scripting events and objects.</li></ol>
<h3><a class="anchor" name="PGScriptingCaveats">
Scripting Caveats</a></h3>
The scripting system has been designed specifically to drive plug-ins in a way that is transparent to the existing operation of the host. This means that there is no way to know whether your plug-in is being driven by the scripting system or an end-user. You should treat all operations as consistently as possible.<p>
The scripting system always hands the plug-in a descriptor at every selector call.<p>
If the plug-in uses a descriptor that was handed to it by the host, and it hands back a new descriptor, the plug-in is responsible for deleting the old descriptor. All the examples do this through the set of utility routines in PIUtilities.<p>
If the plug-in doesn�t use the descriptor handed to it by the host, the plug-in can hand it back and it will be deleted automatically.<p>
If the plug-in doesn�t use the descriptor handed to it by the host, but the plug-in hands back NULL, then the plug-in is responsible for deleting the descriptor the host handed it.<h2><a class="anchor" name="PGScriptingCreatingResource">
Creating a Terminology Resource</a></h2>
A terminology resource is used to specify the mapping from a descriptor to human readable text. The format of the terminology resource is identical to an AppleEvent terminology resource. <code>CNVTPIPL.EXE</code> on Windows understands this resource and converts it accordingly. All the example plug-ins have a rez entry in the <em>plugInName.r</em> file for an <code>'aete'</code> resource.<p>
For further information on the 'aete' resource, see "Making Sense of 'aete' Resources" (Richard McGath, MacTech, Volume 11, issue 7), found in the <a href="http://www.mactech.com/articles">MacTech Article Archives</a>.<p>
To let Photoshop know that the terminology resource is present, a PiPL property is added, <code>HasTerminology</code> (<code>'hstm'</code>), which contains the class ID, event ID, and terminology resource ID for your plug-in. See <a class="el" href="group___pi_p_l_scripting_keys.html">Scripting-specific PiPL Properties</a>.<p>
The terminology resource is a complex structure designed by Apple to cover numerous scripting situations that are not required by Photoshop. By that nature, the structure is more complicated than it needs to be to describe plug-ins. However, it was chosen because Apple plans to support it both now and in the future, and it allows you to increase the scope of your plug-in by being AppleEvent- and AppleScript-savvy. See <a class="el" href="pgscriptingplugins.html#PGScriptingApplescriptCompatiblity">AppleScript Compatibility</a>.<h3><a class="anchor" name="PGScriptingBasicResource">
Basic Terminology Resource Format</a></h3>
<div class="fragment"><pre class="fragment">resource 'aete' (0)
{   <span class="comment">// aete version and language specifiers</span>
    { <span class="comment">// suite descriptor </span>
        { <span class="comment">// filter/selection/color picker descriptor </span>
            { <span class="comment">// any parameters </span>
                <span class="comment">// additional parameters </span>
            }
        },
        { <span class="comment">// import/export/format descriptors </span>
            { <span class="comment">// properties. First property defines inheritance. </span>
                <span class="comment">// any properties </span>
            },
            { <span class="comment">// elements. Not supported for plug-ins. </span>
            },
            <span class="comment">// class descriptions for other classes used as parameters or properties </span>
        },
        { <span class="comment">// comparison ops. Not currently supported. </span>
        },
        { <span class="comment">// any enumerations </span>
            {
                <span class="comment">// additional values for enumeration </span>
            },
            <span class="comment">// any additional enumerations </span>
            <span class="comment">// variant types are a special enumeration: </span>
            {
                <span class="comment">// additional types for variant </span>
            },
            <span class="comment">// any additional variants </span>
            <span class="comment">// class and reference types are a special enumeration: </span>
            {
            },
            <span class="comment">// any additional class or reference types </span>
        }
    }
}
</pre></div><p>
Whether your plug-in is a filter, or one of the others, each section of the terminology resource must be present (even if it is blank <code>"{},"</code>).<h3><a class="anchor" name="PGSCriptingDetailedResource">
Detailed Terminology Resource Example</a></h3>
<div class="fragment"><pre class="fragment">resource 'aete' (0)
{
    1, 0, english, roman,                   <span class="comment">// aete version and language specifiers</span>
    { <span class="comment">// suite descriptor below         </span>
        <span class="stringliteral">"suite name"</span>,                       <span class="comment">// name of suite</span>
        <span class="stringliteral">"description"</span>,                      <span class="comment">// optional description of suite</span>
        'stID',                             <span class="comment">// suite ID, must be unique 4-char code</span>
        1,                                  <span class="comment">// suite code, must be 1</span>
        1,                                  <span class="comment">// suite level, must be 1</span>
        { <span class="comment">// filter/selection/color picker descriptor below </span>
            <span class="stringliteral">"plug-in name"</span>,                 <span class="comment">// name of plug-in, must be unique</span>
            <span class="stringliteral">"description"</span>,                  <span class="comment">// optional description of filter</span>
            'clID',                         <span class="comment">// class ID, must be unique </span>
                                            <span class="comment">// 4-char code or suite ID</span>
            'evID',                         <span class="comment">// event ID, must be unique 4-char </span>
                                            <span class="comment">//code within class (may be suite ID)</span>
            <a class="code" href="_p_i_actions_8h.html#939bb1a618a2aee2a104aa5807fa5928">NO_REPLY</a>,                       <span class="comment">// never a reply</span>
            <a class="code" href="_p_i_actions_8h.html#f65790b6475647104099bc6e4608c8de">IMAGE_DIRECT_PARAMETER</a>          <span class="comment">// direct parameter</span>
            { <span class="comment">// any parameters below </span>
            <span class="stringliteral">"parameter name"</span>,               <span class="comment">// name of parameter</span>
            'kyID',                         <span class="comment">// parameter key ID. </span>
            'tyID',                         <span class="comment">// parameter type ID. </span>
            flagsTypeParameter,             <span class="comment">// parameter flags. </span>
            <span class="comment">// additional parameters here </span>
            }
        },
        { <span class="comment">// import/export/format descriptors below </span>
            <span class="stringliteral">"plug-in name"</span>,                 <span class="comment">// name of plug-in, must be unique</span>
            'clID',                         <span class="comment">// class ID, must be unique </span>
                                            <span class="comment">// 4-char code or suite ID</span>
            <span class="stringliteral">"description"</span>,                  <span class="comment">// optional description of plug-in</span>
            { <span class="comment">// properties below. First property defines inheritance. </span>
                <span class="stringliteral">"&lt;Inheritance&gt;"</span>,            <span class="comment">// required</span>
                <a class="code" href="_p_i_terminology_8h.html#3f7d59502700d85fbf0087dfcbea95ff103efc3cf297e131652c33d63c14dbbd">keyInherits</a>,                <span class="comment">// required</span>
                classInherited,             <span class="comment">// parent class: Format, Import, or Export</span>
                <span class="stringliteral">""</span>,                         
                <a class="code" href="_p_i_actions_8h.html#3ee7406320fa79b320da6947997228c4">flagsSingleProperty</a>,
                <span class="comment">// any properties below </span>
                <span class="stringliteral">"property name"</span>,            <span class="comment">// name of property</span>
                'kyID',                     <span class="comment">// property key ID. </span>
                'tyID',                     <span class="comment">// property type ID. </span>
                <span class="stringliteral">"description"</span>,              <span class="comment">// optional description</span>
                flagsTypeProperty,          <span class="comment">// property flags. </span>
            },                              
            { <span class="comment">// elements. Not supported for plug-ins. </span>
            },
            <span class="comment">// class descriptions for other classes used as parameters or properties </span>
        },
        { <span class="comment">// comparison ops. Not currently supported. </span>
        },
        { <span class="comment">// any enumerations below </span>
            'enID',                         <span class="comment">// enumeration ID</span>
            {                               
                <span class="stringliteral">"enumerated name"</span>,          <span class="comment">// first value name</span>
                'e1ID',                     <span class="comment">// first value ID</span>
                <span class="stringliteral">"description"</span>,              <span class="comment">// optional description of first value</span>
                <span class="comment">// additional values for this enumeration </span>
            },
            <span class="comment">// any additional enumerations </span>
            <span class="comment">// variant types are a special enumeration: </span>
            '#vID',                         <span class="comment">// variant ID (must begin with "#")</span>
            {                               
                <span class="stringliteral">"type name"</span>,                <span class="comment">// first type name</span>
                'v1ID',                     <span class="comment">// first type ID</span>
                <span class="stringliteral">""</span>,
                <span class="comment">// additional types for variant </span>
            },
            <span class="comment">// any additional variants </span>
            <span class="comment">// class and reference types are a special enumeration: </span>
            '#tID',                         <span class="comment">// enumeration ID (must begin with "#")</span>
            {                               
                <span class="stringliteral">"type name"</span>,                <span class="comment">// name of type</span>
                't1ID',                     <span class="comment">// type ID. Either typeClass or </span>
                                            <span class="comment">// typeObjectReference.</span>
                <span class="stringliteral">""</span>
            },
            <span class="comment">// any additional class or reference types </span>
        }
    }
}
</pre></div><h3><a class="anchor" name="PGSCriptingNomenclature">
Nomenclature</a></h3>
The user terms in the terminology resource should be all lower case with the exception of proper names and acronyms. Photoshop will capitalize terms appropriately.<h3><a class="anchor" name="PGScriptingParametersAndProperties">
Parameters and Properties</a></h3>
The terminology resource has two basic ways to describe information a Photoshop plug-in needs to provide scripting.<p>
For Filter, Selection and Color Picker plug-ins, <em>parameters</em> generally provide <em>keys</em> for an <em>event</em> (see <a class="el" href="pgscriptingplugins.html#PGScriptingFilterEvents">Filter, Selection, and Color Picker Events</a>). They usually describe input that a plug-in receives from the user through the plug-in user interface.<p>
For Import, Export and Format plug-ins, input from the user is structured through class definitions, which are <code>objects</code> that a <code>command</code> acts on. See <a class="el" href="pgscriptingplugins.html#PGScriptingClasses">Classes and the Terminology Resource</a> and <a class="el" href="pgscriptingplugins.html#PGScriptingImportObjects">Import, Export, and Format Objects</a>. <em>Properties</em> provide information about a class.<p>
In the terminology resource, both parameters and properties are defined by four basic pieces of information:<ul>
<li>A name, a string that provides the parameter or property name that appears in the Actions Palette.</li><li>A key, a four character unique identifier for the property or parameter. You can define keys for your plug-in, or use the Photoshop pre-defined keys.</li><li>A type, the data type for the parameter, e.g. <code>typeInteger</code>. See <a class="el" href="pgscriptingplugins.html#TableValueTypes">Basic Value Types</a>.</li><li>A set of flags, which provide information about how the property or parameter is used. See <a class="el" href="pgscriptingplugins.html#PGSCriptingFlags">Parameter and Property Flags</a>.</li></ul>
<h4><a class="anchor" name="PGSCriptingFlags">
Parameter and Property Flags</a></h4>
Parameter and property flags provide information about how parameters and properties are used.<p>
Parameter flags indicate,for example, whether the parameter takes single or multiple values, or whether its value comes from an enumeration. See the <code>Dissolve.r</code> file in <a class="el" href="pgsamplecode.html#SampleFilterDissolve">Dissolve</a> filter sample code for use of parameter flags in a PiPL resource.<p>
Similarly, property flags indicate, for example, whether an object can have one or more of a particular property, or whether its value comes from an enumeration. See the <code>GradientImport.r</code> file in <a class="el" href="pgsamplecode.html#SampleImportGradient">GradientImport</a> sample code for use of property flags in a PiPL resource.<p>
The Photoshop SDK predefines flags for parameters and properties, which make coding of the 'aete' resource somewhat simpler. See <a class="el" href="_p_i_actions_8h.html#ResourceParameterFlags">parameter flags</a> and <a class="el" href="_p_i_actions_8h.html#ResourcePropertyFlags">property flags.</a><p>
The flags for properties are the same for parameters, except there is not a flag for optional properties. Properties can be optional by putting "optional" at the beginning of the description field.<p>
<dl class="note" compact><dt><b>Note:</b></dt><dd>The AppleScript Editor doesn�t display parameter type list correctly. In order for the dictionary to read correctly, the description field for the type should begin with the word "list".</dd></dl>
<h3><a class="anchor" name="PGScriptingClasses">
Classes and the Terminology Resource</a></h3>
For Import, Export, and Format plug-ins, the first property in the terminology resource must indicate inheritance (<code>"&lt;Inheritance&gt;"</code>) from the base class for the plug-in. For example, Import plug-ins need to inherit from the base class <code>classImport</code>. Additional classes may be defined as templates for parameters or properties.<p>
The Photoshop SDK provides a number of "predefined classes" that are available for use in the terminology resource. A useful subset of those classes is shown in the table below. Use these classes when they are appropriate, but you can define new classes in the terminology resource, if necessary. See the <code>GradientImport.r</code> file in <a class="el" href="pgsamplecode.html#SampleImportGradient">GradientImport</a> sample code for an example of defining a class (<code>classMultiImportStruct</code>) in a terminology resource.<p>
<a class="anchor" name="TablePredefinedClasses"></a> <table border="1" 
 summary="A Selection of Useful Predefined Classes" cellspacing="3" cellpadding="3">
<caption align="bottom"><em>A Selection of Useful Predefined Classes</em></caption>
<tr>
<th>Name </th><th>Code </th><th>Description/keys </th></tr>
<tr>
<td>classImport </td><td>'Impr' </td><td>Class for Import modules. </td></tr>
<tr>
<td>classExport </td><td>'Expr' </td><td>Class for Export modules. </td></tr>
<tr>
<td>classFormat </td><td>'Fmt ' </td><td>Class for Format modules. </td></tr>
<tr>
<td>classColor </td><td>'Clr ' </td><td>Class for color classes. </td></tr>
<tr>
<td>classRGBColor </td><td>'RGBC' </td><td>keyRed, keyGreen, keyBlue </td></tr>
<tr>
<td>classCMYKColor </td><td>'CMYC' </td><td>keyCyan, keyMagenta, keyYellow, keyBlack. </td></tr>
<tr>
<td>classUnspecifiedColor </td><td>'UnsC' </td><td>Unspecified. </td></tr>
<tr>
<td>classGrayscale </td><td>'Grsc' </td><td>keyGray </td></tr>
<tr>
<td>classBookColor </td><td>'BkCl' </td><td>Book color. </td></tr>
<tr>
<td>classLabColor </td><td>'LbCl' </td><td>keyLuminance, keyA, keyB. </td></tr>
<tr>
<td>classHSBColor </td><td>'HSBC' </td><td>keyHue, keySaturation, keyBrightness. </td></tr>
<tr>
<td>classPoint </td><td>'Pnt ' </td><td>keyHorizontal, keyVertical. </td></tr>
</table>
<h4><a class="anchor" name="PGScriptingInheritance">
Class Inheritance</a></h4>
The Inheritance property (<code>"&lt;Inheritance&gt;"</code>) can also be used to specify a hierarchy of types. Inheritance is used by defining a base class with the first property configured with:<p>
<ul>
<li>Name = the name of the class;</li><li>Type = class type.</li></ul>
<p>
Class types are defined by creating a special enumeration.<p>
For example, the class <code>"RGB color"</code> is defined based on the class <code>"color"</code>. If the class <code>color</code> is specified as a parameter or property type, then any of its subclasses are acceptable. Here is a definition for the class <code>color:</code> <p>
<div class="fragment"><pre class="fragment">    { <span class="comment">/* suite descriptor below */</span>
        <span class="stringliteral">"color"</span>,                        <span class="comment">// class name</span>
        <a class="code" href="_p_i_terminology_8h.html#b98c662d7053b2152ed7c1611b889d88ea30c2a1235b82c528bcce0526172126">classColor</a>,                     <span class="comment">// class ID for Color 'Clr '</span>
        <span class="stringliteral">""</span>,                             <span class="comment">// no description</span>
        {
            <span class="stringliteral">"color"</span>,                    <span class="comment">// color property (special for base class)</span>
            <a class="code" href="_p_i_terminology_8h.html#3f7d59502700d85fbf0087dfcbea95ff9631f0b226faef059e2a98979bf47cc0">keyColor</a>,                   <span class="comment">// property ID for Color 'Clr '</span>
            <a class="code" href="_p_i_terminology_8h.html#61ab175d0227ec09bd2ae63edc5da91bb108c1d04a24a9db7fb6399e6a56b230">typeClassColor</a>,             <span class="comment">// type this class</span>
            <span class="stringliteral">""</span>,                         <span class="comment">// no description</span>
            <a class="code" href="_p_i_actions_8h.html#e9c4f3a57c292540a80fd7c906e51e52">flagsEnumeratedParameter</a>    <span class="comment">// "type" is special enumeration</span>
        },
        { <span class="comment">/* no elements */</span>
        }
        ...
    }
</pre></div><p>
The class <code>RGB color</code> is defined: <div class="fragment"><pre class="fragment">    <span class="stringliteral">"RGB color"</span>,    <span class="comment">// class name</span>
    <a class="code" href="_p_i_terminology_8h.html#b98c662d7053b2152ed7c1611b889d88805d2164d7e2e0699c00ae9438d8269b">classRGBColor</a>,  <span class="comment">// class ID 'RGBC'</span>
    <span class="stringliteral">""</span>, <span class="comment">// no description</span>
        {
            <span class="stringliteral">"&lt;Inheritance&gt;"</span>,            <span class="comment">// define inheritance</span>
            <a class="code" href="_p_i_terminology_8h.html#3f7d59502700d85fbf0087dfcbea95ff103efc3cf297e131652c33d63c14dbbd">keyInherits</a>,                <span class="comment">// property ID for inheritance 'Clr '</span>
            <a class="code" href="_p_i_terminology_8h.html#b98c662d7053b2152ed7c1611b889d88ea30c2a1235b82c528bcce0526172126">classColor</a>,                 <span class="comment">// from parent class "color"</span>
            <span class="stringliteral">""</span>,                         <span class="comment">// no description</span>
            <a class="code" href="_p_i_actions_8h.html#c219304f69f4a95c376e338432cc6f2b">flagsSingleParameter</a>        <span class="comment">// single parameter</span>

            <span class="stringliteral">"red"</span>,                      <span class="comment">// red property</span>
            <a class="code" href="_p_i_terminology_8h.html#3f7d59502700d85fbf0087dfcbea95ff471d2c05e57441acbf234ebba562dc60">keyRed</a>,                     <span class="comment">// property ID for Red 'Rd  '</span>
            typeFloat,                  <span class="comment">// value type "float"</span>
            <span class="stringliteral">""</span>,                         <span class="comment">// no description</span>
            flagsSingleParameter        <span class="comment">// single parameter</span>

            <span class="stringliteral">"green"</span>,                    <span class="comment">// green property</span>
            <a class="code" href="_p_i_terminology_8h.html#3f7d59502700d85fbf0087dfcbea95ff60d1009366a5bbed5b0fc3db5b0234eb">keyGreen</a>,                   <span class="comment">// property ID for Green 'Grn '</span>
            typeFloat,                  <span class="comment">// value type "float"</span>
            <span class="stringliteral">""</span>,                         <span class="comment">// no description</span>
            flagsSingleParameter        <span class="comment">// single parameter</span>

            <span class="stringliteral">"blue"</span>,                     <span class="comment">// blue property</span>
            <a class="code" href="_p_i_terminology_8h.html#3f7d59502700d85fbf0087dfcbea95ff0e9f908ce6e81b75cde0a7256b4d5cc5">keyBlue</a>,                    <span class="comment">// property ID for Blue 'Bl  '</span>
            typeFloat,                  <span class="comment">// value type "float"</span>
            <span class="stringliteral">""</span>,                         <span class="comment">// no description</span>
            flagsSingleParameter        <span class="comment">// single parameter</span>
        },
        { <span class="comment">/* no elements */</span>
        }
</pre></div><h3><a class="anchor" name="PGScriptingEnumeratedTypes">
Enumerated Types</a></h3>
Enumerated types are used in the standard fashion to create a type that can have one or a set of values. See <code>Dissolve.r</code> in the <a class="el" href="pgsamplecode.html#SampleFilterDissolve">Dissolve example</a> for an example of creating an enumeration in a PiPL resource.<p>
<dl class="note" compact><dt><b>Note:</b></dt><dd>For the enumerated value IDs, as tempting as it may be, don�t use simple indexes, use four-character types.</dd></dl>
For example, an enumerated type for quality with the values of low, medium, high, and maximum is defined: <div class="fragment"><pre class="fragment">    <a class="code" href="_p_i_terminology_8h.html#61ab175d0227ec09bd2ae63edc5da91bb690bc45b09f043bb7d6cf42745bbc63">typeQuality</a>,    <span class="comment">// type ID for Quality 'Qlty'</span>
    {
        <span class="stringliteral">"low"</span>,      <span class="comment">// "low" value</span>
        <a class="code" href="_p_i_terminology_8h.html#16d72b5a109d04b93ad00a71f9a07d1cd45f188159d05eabb27a559253c97b65">enumLow</a>,    
        <span class="stringliteral">""</span>, 

        <span class="stringliteral">"medium"</span>,   <span class="comment">// "medium" value</span>
        <a class="code" href="_p_i_terminology_8h.html#16d72b5a109d04b93ad00a71f9a07d1c2edfbd9e829e43d169e0487c2ccee82e">enumMedium</a>, 
        <span class="stringliteral">""</span>, 

        <span class="stringliteral">"high"</span>,     <span class="comment">// "high" value</span>
        <a class="code" href="_p_i_terminology_8h.html#16d72b5a109d04b93ad00a71f9a07d1c4c0efd6b4ca8f36c77bf65fd69ad8dc4">enumHigh</a>,   
        <span class="stringliteral">""</span>, 

        <span class="stringliteral">"maximum"</span>,  <span class="comment">// "maximum" value</span>
        <a class="code" href="_p_i_terminology_8h.html#16d72b5a109d04b93ad00a71f9a07d1c8c43494e1c576a7c8563e3e513db91a4">enumMaximum</a>,    
        <span class="stringliteral">""</span>, 
    }
</pre></div><h4><a class="anchor" name="VarientTypes">
Variant types</a></h4>
Enumerated types are also used to specify variant types for parameters and properties.<p>
<dl class="note" compact><dt><b>Note:</b></dt><dd>The first character of a variant type ID must be "#".</dd></dl>
If you have a parameter that can take text or an integer, it is defined:<p>
<div class="fragment"><pre class="fragment">    <span class="stringliteral">"specifier"</span>,        <span class="comment">// parameter name</span>
    keySpecifier,       <span class="comment">// parameter ID</span>
    typeTextInteger,    <span class="comment">// text or integer</span>
    <span class="stringliteral">"index or name"</span>,    <span class="comment">// short description</span>
    <a class="code" href="_p_i_actions_8h.html#e9c4f3a57c292540a80fd7c906e51e52">flagsEnumeratedParameter</a>
</pre></div><p>
Where <code>typeTextInteger</code> is defined as <code>"#tin"</code>.<p>
In the PiPL resource file, the type <code>typeTextInteger</code> is defined an enumeration: <div class="fragment"><pre class="fragment">typeTextInteger,        <span class="comment">// type ID (variant types must begin with "#")</span>
    {
        <span class="stringliteral">"string"</span>,       <span class="comment">// name of first type (AppleScript name)</span>
        typeText,   
        <span class="stringliteral">""</span>, 

        <span class="stringliteral">"integer"</span>,      <span class="comment">// name of second type</span>
        typeInteger,    
        <span class="stringliteral">""</span>  
    }
</pre></div><p>
<b>Enumerations and object reference types</b> Enumeration variants can also be used to specify object reference types and class types. From the example of the class color, typeClassColor is defined:<p>
<div class="fragment"><pre class="fragment">    <a class="code" href="_p_i_terminology_8h.html#61ab175d0227ec09bd2ae63edc5da91bb108c1d04a24a9db7fb6399e6a56b230">typeClassColor</a>,     <span class="comment">// type ID (variant types must begin with "#")</span>
    {
        <span class="stringliteral">"type color"</span>,   <span class="comment">// name of type</span>
        <a class="code" href="_p_i_terminology_8h.html#61ab175d0227ec09bd2ae63edc5da91bec7e6b895382cb35f000d42f1530e142">typeClass</a>,      <span class="comment">// generic type reference</span>
        <span class="stringliteral">""</span>, 
    }
</pre></div><h3><a class="anchor" name="PGScriptingLists">
Lists and the Terminology Resource</a></h3>
All types can be used as lists for parameters and properties. All items in a list must be of the same type. To specify a list in the terminology resource use the <a class="el" href="_p_i_actions_8h.html#e09c122800379e13362c7e53d960adff">flagsListParameter</a> or <a class="el" href="_p_i_actions_8h.html#dc385f4b4008f75f4ee14d2778130e3d">flagsListProperty</a>.<h2><a class="anchor" name="PGscriptingDescriptor">
Descriptors</a></h2>
Because the Actions palette provides an alternate, text-based user interface to Adobe Photoshop, textual script commands need to map intuitively to the graphical user interface. The way to start developing a scripting interface for your plug-in is to look carefully at the options provided in your dialogs, and then describe them in writing.<p>
For some options, such as checkboxes and popup menus, this is fairly straight-forward. For others, such as showing placement of an object graphically, this is more difficult.<p>
All scripting commands are described with the following form within the Actions palette. This form provides a <em>descriptor</em> for the event. <dl class="user" compact><dt><b></b></dt><dd><em>event</em> [<em>target</em>] [&lt;<em>key&gt;</em> &lt;<em>value&gt;</em>]</dd></dl>
<table border="1" 
 summary="Scripting command syntax" cellspacing="3" cellpadding="3">
<caption align="bottom"><em>Scripting command syntax</em></caption>
<tr>
<th>Name </th><th>Description </th></tr>
<tr>
<td>event </td><td>Command being executed. </td></tr>
<tr>
<td>target </td><td>Item being acted upon. </td></tr>
<tr>
<td>key </td><td>Parameter key. </td></tr>
<tr>
<td>value </td><td>Parameter value type. See <a class="el" href="pgscriptingplugins.html#TableValueTypes">Basic Value Types</a> </td></tr>
</table>
<p>
<a class="anchor" name="TableValueTypes"></a> <table border="1" 
 summary="Basic value types" cellspacing="3" cellpadding="3">
<caption align="bottom"><em>Basic value types</em></caption>
<tr>
<th>Name </th><th>Code </th><th>Description </th></tr>
<tr>
<td>typeInteger </td><td><code>'long'</code> </td><td><code>int32</code> </td></tr>
<tr>
<td>typeFloat </td><td><code>'doub'</code> </td><td>IEEE 64 bit double </td></tr>
<tr>
<td>typeBoolean </td><td><code>'bool'</code> </td><td><code>TRUE</code> or <code>FALSE</code>. </td></tr>
<tr>
<td>typeText </td><td><code>'TEXT'</code> </td><td>Block of any number of readable characters. </td></tr>
<tr>
<td>typeAlias </td><td><code>'alis'</code> </td><td>Macintosh file system path. </td></tr>
<tr>
<td>typePaths </td><td><code>'Pth</code> ' </td><td>Windows file system path. </td></tr>
<tr>
<td>typePlatformFilePath </td><td><code>'alis'</code> or <code>'Pth</code> ' </td><td><code>typeAlias</code> for Macintosh, <code>typePath</code> for Windows. </td></tr>
</table>
<p>
<table border="1" 
 summary="Special value types" cellspacing="3" cellpadding="3">
<caption align="bottom"><em>Special value types</em></caption>
<tr>
<th>Name </th><th>Code </th><th>Description </th></tr>
<tr>
<td>typeEnumeration </td><td></td><td>Enumeration declared in the terminology resource. </td></tr>
<tr>
<td>typeClass </td><td><code>'char'</code> </td><td>Used in terminology resource for class type specifier. </td></tr>
<tr>
<td>typeObjectReference </td><td><code>'indx'</code> </td><td>Refers to Photoshop object, such as channel or layer. See <a class="el" href="pgscriptingplugins.html#PGScriptingObjectRef">Type typeObjectReference</a>. </td></tr>
<tr>
<td>classClass </td><td></td><td>Enumerated class. See <a class="el" href="pgscriptingplugins.html#TablePredefinedClasses">Predefined Classes.</a> </td></tr>
</table>
<h3><a class="anchor" name="PGScriptingFilterEvents">
Filter, Selection, and Color Picker Events</a></h3>
Filter, Selection, and Color Picker scripting is described as "scripting events". These events have a descriptor syntax in the Actions palette with the following form: <dl class="user" compact><dt><b></b></dt><dd><em>filter</em> [<em>target</em>] [&lt;<em>key&gt;</em> &lt;<em>value&gt;</em>]</dd></dl>
Such as: <dl class="user" compact><dt><b></b></dt><dd><code> gaussian blur layer 1 radius 5 </code></dd></dl>
<table border="1" 
 summary="Scripting event command syntax" cellspacing="3" cellpadding="3">
<caption align="bottom"><em>Scripting event command syntax</em></caption>
<tr>
<th>Name </th><th>Description (with example) </th></tr>
<tr>
<td>filter </td><td>Menu name of the filter plug-in, or similar. (<code>"gaussian blur"</code>) </td></tr>
<tr>
<td>target </td><td>Portion of the document to apply filter. (<code>"layer 1"</code>) </td></tr>
<tr>
<td>key </td><td>Parameter key. (<code>"radius"</code>) </td></tr>
<tr>
<td>value </td><td>Parameter value. (<code>"5"</code>) </td></tr>
</table>
<h3><a class="anchor" name="PGScriptingImportObjects">
Import, Export, and Format Objects</a></h3>
Import, Export, and Format scripting is described as "scripting objects". These objects have a descriptor syntax in the Actions palette with the following form: <dl class="user" compact><dt><b></b></dt><dd><em>command</em> [<em>target</em>] [as <em>type</em> | <em>object</em> | <em>string</em>] [in <em>file</em> | <em>folder</em>]</dd></dl>
Such as: <dl class="user" compact><dt><b></b></dt><dd><code> save document "bright banana" as "Shareware" <br>
 save document 1 as Photoshop EPS <br>
 save as Photoshop EPS { preview 8 bit TIFF } </code></dd></dl>
<table border="1" 
 summary="Scripting object command syntax" cellspacing="3" cellpadding="3">
<caption align="bottom"><em>Scripting object command syntax</em></caption>
<tr>
<th>Name </th><th>Description (with example) </th></tr>
<tr>
<td>command </td><td>Operation: "save" or "open". (<code>"save"</code>) </td></tr>
<tr>
<td>target </td><td>Document. (<code>"document 1"</code>) </td></tr>
<tr>
<td>as </td><td>type = type of class (<code>"TIFF"</code>) <br>
 object = object of class (<code>"Photoshop EPS"</code>) <br>
 string = name of non-scriptable format (<code>"Shareware"</code>) </td></tr>
<tr>
<td>in </td><td>Location to save/load the file. </td></tr>
</table>
<p>
In the example <code>"save as Photoshop EPS { preview 8 bit TIFF }"</code> the target document is saved with the "Photoshop EPS" format with the parameter: key <code>"preview"</code>, value <code>"8 bit TIFF"</code>.<p>
<dl class="note" compact><dt><b>Note:</b></dt><dd>This form is a little different then AppleScript. In AppleScript, the "save as Photoshop EPS" example would appear as: <code> save as {format: Photoshop EPS, preview: 8 bit TIFF} </code> <br>
<br>
 In Photoshop the object�s class is implied by the object passed since the scripting mechanism has a stronger type system than AppleScript.</dd></dl>
<h4><a class="anchor" name="SaveAsObject">
Save as object</a></h4>
To save as an object, the nomenclature is <code>save</code> <code>as</code> <em>classFormat</em>, where <em>classFormat</em>, is generally a class type with parameters, such as <code>JPEG</code>, <code>PDF</code>, or <code>EPS:</code> <dl class="user" compact><dt><b></b></dt><dd><code> save as { class: JPEG, quality: 3 } <br>
 save as JPEG with properties { quality: 5 } </code></dd></dl>
<h4><a class="anchor" name="SaveAsType">
Save as type</a></h4>
Saving as a type takes the form of <code>save</code> <code>as</code> <em>typeClassFormat</em>, which is always a specific type, with no parameters: <dl class="user" compact><dt><b></b></dt><dd><code> save as JPEG <br>
 save as EPS </code></dd></dl>
<h3><a class="anchor" name="PGScriptingObjectRef">
Type typeObjectReference</a></h3>
The type <code>typeObjectReference</code> is used to refer to an external object, such as a channel or layer. Plug-ins cannot access these objects directly but can use object references to refer to elements that are accessible through other means.<p>
When using the <a class="el" href="group___pica_action_descriptor_suite.html">Action Descriptor Suite</a>, the read and write functions <code>GetReference</code> and <code>PutReference</code> use the structure <a class="el" href="_p_i_actions_8h.html#e96dd233b37976f6eb59d8292a7b293c">PIActionReference</a> for keys that have type <code>typeObjectReference</code>. The <code>PIActionReference</code> structure itself is read and written using the <a class="el" href="group___pica_action_reference_suite.html">Action Reference Suite</a>. When using the <a class="el" href="group___descriptor_suite.html">Deprecated Standard Descriptor Suite</a>, the read and write functions <code>GetSimpleReferenceProc</code> and <code>PutSimpleReferenceProc</code> use the structure <code><a class="el" href="struct_p_i_descriptor_simple_reference.html">PIDescriptorSimpleReference</a></code> for keys that have type <code>typeObjectReference</code>.<p>
An object reference can refer to an object which is either an element or a property of another object. Elements may be referred to by name or index. Plug-ins can only refer to elements or properties of the immediate target, due to the one-dimensional nature of <code><a class="el" href="struct_p_i_descriptor_simple_reference.html">PIDescriptorSimpleReference</a></code>. For example, your plug-in may specify:<p>
<dl class="user" compact><dt><b></b></dt><dd><code>channel 1</code></dd></dl>
But it cannot specify:<p>
<dl class="user" compact><dt><b></b></dt><dd><code>channel 1 of layer 2</code></dd></dl>
If a plug-in attempts to read a complex object reference (for instance, one containing other references) the host attempts to simplify the reference; if it can�t, it returns an error.<h2><a class="anchor" name="PGScriptingParameters">
Scripting Parameters</a></h2>
Once you�ve added a terminology resource and you�ve edited the <code>HasTerminology</code> PiPL property (see the <a href="../Plug-in Resource Guide.pdf">Cross Application Plug-in Development Resource Guide</a>), your plug-in is considered scripting-aware.<p>
At every selector call, the host passes the plug-in a descriptor structure through the Descriptor Suite portion of the parameter block: <code><a class="el" href="struct_p_i_descriptor_parameters.html">PIDescriptorParameters</a></code>, pointed to by the field <code>descriptorParameters</code>. This structure contains fields that provide flags for playback and recording, as well as the <code>descriptor</code> field, a set of key/value pairs that provide the plug-in with the key/value portion of the descriptor information displayed on the Actions Palette.<p>
The plug-in can access the data structure in the <code>descriptor</code> field directly using the <a class="el" href="group___descriptor_suite.html">Deprecated Standard Descriptor Suite</a>, or can convert the <code>PIDescriptorHandle</code> structure to a <code>PIActionDescriptor</code> structure by using the <code><a class="el" href="struct_p_s_action_descriptor_procs.html#d0e876703afca27584526ac658576054">PSActionDescriptorProcs::HandleToDescriptor</a></code> and <code><a class="el" href="struct_p_s_action_descriptor_procs.html#e2c55f05b27662f80b1525837b202dfc">PSActionDescriptorProcs::AsHandle</a></code> functions. Once converted to a <code>PIActionDescriptor</code>, the plug-in can use the <a class="el" href="group___pica_action_descriptor_suite.html">Action Descriptor Suite</a> to manipulate the descriptor.<p>
See the <a class="el" href="pgsamplecode.html#SampleFilterHidden">Hidden</a> sample for an example of converting the <code>PIDescriptorHandle</code> structure to a <code>PIActionDescriptor</code>, and using the Action Descriptor Suite to access the descriptor.<h2><a class="anchor" name="PGScriptingRecording">
Recording</a></h2>
<b>Building a descriptor</b> <br>
<p>
If your plug-in has no options, <code><a class="el" href="struct_p_i_descriptor_parameters.html#01a2a15707e75184483e241318495f93">PIDescriptorParameters::descriptor</a></code> may be set to NULL.<p>
To build a descriptor using the <a class="el" href="group___pica_action_descriptor_suite.html">Action Descriptor Suite</a>:<ol type=1>
<li>Call <code><a class="el" href="struct_p_s_action_descriptor_procs.html#48e09112a59e7e308242330cde6510eb">PSActionDescriptorProcs::Make</a></code> to create a new <code>PIActionDescriptor</code> token, such as <em>actionDescriptor</em>.</li><li>Call various <code><a class="el" href="struct_p_s_action_descriptor_procs.html">PSActionDescriptorProcs</a></code> <code>Put</code> routines such as <code>PutInteger</code>, <code>PutFloat</code>, etc., to add key/value pairs to <em>actionDescriptor</em>. The keys and value types must correspond to those in your terminology resource.</li><li>Check if the <code><a class="el" href="struct_p_i_descriptor_parameters.html#01a2a15707e75184483e241318495f93">PIDescriptorParameters::descriptor</a></code> structure is NULL. Each plug-in has a pointer to <code>PIDescriptorParameters</code> in its parameter block through the field <code>descriptorParameters</code>. If it is not NULL, dispose of it using the <code>Dispose</code> function in the <a class="el" href="group___pica_handle_suite.html">Handle Suite Callbacks</a>.</li><li>Call <code><a class="el" href="struct_p_s_action_descriptor_procs.html#e2c55f05b27662f80b1525837b202dfc">PSActionDescriptorProcs::AsHandle</a></code> with the <em>actionDescriptor</em> token, which converts the <code>PIActionDescriptor</code> structure into a <code>PIDescriptorHandle</code>.</li><li>Place the <code>PIDescriptorHandle</code> into the <code>PIDescriptorParametersdescriptor</code> field. The host disposes of it when finished.</li><li>Free the <em>actionDescriptor</em> using <code><a class="el" href="struct_p_s_action_descriptor_procs.html#a9ea230997ceeb9716a7697e4eece5a1">PSActionDescriptorProcs::Free</a></code>.</li><li>Store your recording information into <code><a class="el" href="struct_p_i_descriptor_parameters.html#b3d3c8e749ab55795dffb6cbb9897586">PIDescriptorParameters::recordInfo</a></code>. See <a class="el" href="_p_i_actions_8h.html#dialogRecordEnum">Dialog Record Options</a>.</li></ol>
<p>
The following example of building a descriptor using the Action Descriptor Suite is from the <code>WriteScriptParamters</code> function in the <a class="el" href="pgsamplecode.html#SampleFilterHidden">Hidden</a> sample code. <div class="fragment"><pre class="fragment">    <a class="code" href="_p_i_actions_8h.html#300cd9ffe9c177ec5147fa395833d127">PIActionDescriptor</a> actionDescriptor = NULL;
    
    <span class="comment">// Create the action descriptor</span>
    HERROR(sPSActionDescriptor-&gt;Make(&amp;actionDescriptor));

    <span class="comment">// Put the descriptor key/value pairs into the descriptor</span>
    HERROR(sPSActionDescriptor-&gt;PutEnumerated(actionDescriptor, 
                                         keyResult, 
                                         typeResult, 
                                         enumResult));

    <span class="comment">// See if we need to clear the handle of an existing descriptor</span>
    <span class="keywordflow">if</span> (filterRecord-&gt;descriptorParameters != NULL &amp;&amp; 
        filterRecord-&gt;descriptorParameters-&gt;descriptor != NULL &amp;&amp;
        filterRecord-&gt;handleProcs != NULL)
    {
        <a class="code" href="struct_handle_procs.html">HandleProcs</a> * handleProcs = filterRecord-&gt;handleProcs;
        handleProcs-&gt;<a class="code" href="struct_handle_procs.html#c977695a856793a0f677a7458295d9e0">disposeProc</a>(filterRecord-&gt;descriptorParameters-&gt;descriptor);
        filterRecord-&gt;descriptorParameters-&gt;descriptor = NULL;
    }

    <span class="comment">// Convert the Action Descriptor to a PIDescriptorHandle, and return</span>
    <span class="comment">// it in the descriptor parameters structure.</span>
    HERROR(sPSActionDescriptor-&gt;AsHandle(actionDescriptor, 
                        &amp;filterRecord-&gt;descriptorParameters-&gt;descriptor));

    <span class="comment">// Free the action descriptor</span>
    <span class="keywordflow">if</span> (actionDescriptor != NULL) sPSActionDescriptor-&gt;Free(actionDescriptor);
</pre></div><p>
To build a descriptor using the <a class="el" href="group___descriptor_suite.html">Deprecated Standard Descriptor Suite</a>:<ol type=1>
<li>Call <code><a class="el" href="struct_write_descriptor_procs.html#5a2d1e899ee5c7d3429a93be1740eac2">WriteDescriptorProcs::openWriteDescriptorProc</a></code> which returns a <code>PIWriteDescriptor</code> token, such as <em>writeToken</em>.</li><li>Call various <code><a class="el" href="struct_write_descriptor_procs.html">WriteDescriptorProcs</a></code> <code>Put</code> routines such as <code>PutIntegerProc</code>, <code>PutFloatProc</code>, etc., to add key/value pairs to <em>writeToken</em>. The keys and value types must correspond to those in your terminology resource.</li><li>Call <code>CloseWriteDescriptorProc</code> with <em>writeToken</em>, which creates a <code>PIDescriptorHandle</code>.</li><li>Place the <code>PIDescriptorHandle</code> into the <code>PIDescriptorParametersdescriptor</code> field. The host disposes of it when finished.</li><li>Store your recording information into <code><a class="el" href="struct_p_i_descriptor_parameters.html#b3d3c8e749ab55795dffb6cbb9897586">PIDescriptorParameters::recordInfo</a></code>. See <a class="el" href="_p_i_actions_8h.html#dialogRecordEnum">Dialog Record Options</a>.</li></ol>
<h3><a class="anchor" name="RecordingErrorHandling">
Recording Error Handling</a></h3>
If an error occurs during or after <code>PIWriteDescriptor</code>, then <em>writeToken</em> and the new <code>PIDescriptorHandle</code> should be disposed of using <code>DisposePIHandleProc</code> from the <a class="el" href="group___pica_handle_suite.html">Handle Suite Callbacks</a>.<h3><a class="anchor" name="RecordingClasses">
Recording Classes</a></h3>
Plug-ins can declare classes to use as templates for structures. Classes declared by plug-ins cannot contain elements, but can use inheritance. Objects of a particular class are created by defining a descriptor and adding the key/value pairs for the properties. The root property of the base class is not added to the descriptor.<h2><a class="anchor" name="PGScriptingPlayback">
Playback</a></h2>
<b>Reading a descriptor</b> <br>
 If a plug-in has no options, or is not scripting-aware, <code><a class="el" href="struct_p_i_descriptor_parameters.html#01a2a15707e75184483e241318495f93">PIDescriptorParameters::descriptor</a></code> will be NULL.<p>
To read a descriptor using the <a class="el" href="group___pica_action_descriptor_suite.html">Action Descriptor Suite</a>:<ol type=1>
<li>Get the <code>PIDescriptorHandle</code> from <code><a class="el" href="struct_p_i_descriptor_parameters.html#01a2a15707e75184483e241318495f93">PIDescriptorParameters::descriptor</a></code>. Each plug-in has a pointer to <code>PIDescriptorParameters</code> in its parameter block through the field <code>descriptorParameters</code>.</li><li>Convert the <code>PIDescriptorHandle</code> into a <code>PIActionDescriptor</code> (<em>actionDescriptor</em>) by calling <code><a class="el" href="struct_p_s_action_descriptor_procs.html#d0e876703afca27584526ac658576054">PSActionDescriptorProcs::HandleToDescriptor</a></code>.</li><li>Make paired calls to <code><a class="el" href="struct_p_s_action_descriptor_procs.html#0c0ff550e2ed0aef991c4b6442506dec">PSActionDescriptorProcs::HasKey</a></code> followed by the appropriate <code>Get</code> routine, to determine whether the key exists in the <code>actionDescriptor</code>, and if so, to return the data.</li><li>Free the <code>actionDescriptor</code> by calling <code><a class="el" href="struct_p_s_action_descriptor_procs.html#a9ea230997ceeb9716a7697e4eece5a1">PSActionDescriptorProcs::Free</a></code>.</li><li>Update your parameters and show your dialog, depending on <code><a class="el" href="struct_p_i_descriptor_parameters.html#c1fe273770f6f6d07a930de29c71b57c">PIDescriptorParameters::playInfo</a></code>. See <a class="el" href="_p_i_actions_8h.html#dialogPlayEnum">Play Dialog Options</a>.</li></ol>
<p>
The following example of reading a descriptor using the Action Descriptor Suite is from the <code>ReadScriptParamters</code> function in the <a class="el" href="pgsamplecode.html#SampleFilterPropetizer">Propetizer</a> sample code. <div class="fragment"><pre class="fragment">        <span class="comment">// Get the descriptor handle from the parameter block</span>
        <a class="code" href="_p_i_actions_8h.html#253a9e8fb220ebe6a1236970d2e0afad">PIDescriptorHandle</a> descHandle = NULL;
        descHandle = filterRecord-&gt;descriptorParameters-&gt;descriptor;
        
        popDialog = !(filterRecord-&gt;descriptorParameters-&gt;playInfo == <a class="code" href="_p_i_actions_8h.html#bc6126af1d45847bc59afa0aa3216b04e9124c5a29ac557e3066f4222fe21479">plugInDialogSilent</a>);

        <span class="comment">// Convert the descriptor handle into an Action Descriptor</span>
        <a class="code" href="_p_i_actions_8h.html#300cd9ffe9c177ec5147fa395833d127">PIActionDescriptor</a> actionDescriptor = NULL;
        sPSActionDescriptor-&gt;HandleToDescriptor(descHandle, &amp;actionDescriptor);

        Boolean hasKey;
        uint32 length;
    
        <span class="comment">// Call HasKey for each key we expect, followed by the appropriate Get routine.</span>
        error = sPSActionDescriptor-&gt;HasKey(actionDescriptor, keyMyNudgeH, &amp;hasKey);
        <span class="keywordflow">if</span> (!error &amp;&amp; hasKey)
            sPSActionDescriptor-&gt;GetFloat(actionDescriptor, keyMyNudgeH, &amp;fBigNudgeH);

        <span class="comment">// ...</span>

        error = sPSActionDescriptor-&gt;HasKey(actionDescriptor, keyMyWatch, &amp;hasKey);
        <span class="keywordflow">if</span> (!error &amp;&amp; hasKey)
            sPSActionDescriptor-&gt;GetInteger(actionDescriptor, keyMyWatch, &amp;fWatchSuspension);

        <span class="comment">// Free the action descriptor</span>
        <span class="keywordflow">if</span> (actionDescriptor != NULL) sPSActionDescriptor-&gt;Free(actionDescriptor);
    }
</pre></div><p>
To read a descriptor using the <a class="el" href="group___descriptor_suite.html">Deprecated Standard Descriptor Suite</a>:<ol type=1>
<li>Call <code><a class="el" href="struct_read_descriptor_procs.html#8fc79ace95ee691433a46d28831f8e9a">ReadDescriptorProcs::openReadDescriptorProc</a></code> with two parameters: the <code>PIDescriptorHandle</code> in descriptor, and a NULL-terminated array of expected key IDs. It returns a <code>PIReadDescriptor</code> token, such as <em>readToken</em>. <dl class="note" compact><dt><b>Note:</b></dt><dd><code>descriptorKeyIDArray</code> must be NULL-terminated, or the automatic array processor starts to read and write past the array, writing over other data and likely crashing the host.</dd></dl>
</li><li>Make repeated calls to <code><a class="el" href="group___descriptor_suite.html#gc8867c775ca1b71c4b264c64bf6034ea">ReadDescriptorProcs::GetKeyProc</a></code>, which returns information about the current key in the <em>readToken</em>. <code>GetKeyProc</code> returns FALSE when there are no more keys.</li><li>Make the appropriate call to the <code>Get</code> routine responding to the key and type, such as <code>GetIntegerProc</code>, <code>GetFloatProc</code>, etc.</li><li>Call <code><a class="el" href="struct_read_descriptor_procs.html#4d13940e1c0c6af7fb2b0ea14c07a6bd">ReadDescriptorProcs::closeReadDescriptorProc</a></code> with <em>readToken</em>, which disposes of <em>readToken</em> and returns any errors that occurred during <code>GetKeyProc</code>. (See <a class="el" href="pgscriptingplugins.html#StickyErrors">Sticky Errors</a>.)</li><li>Dispose of the <code>PIDescriptorHandle</code> pointed to in descriptor by calling <code>DisposePIHandleProc</code> from the <a class="el" href="group___pica_handle_suite.html">Handle Suite Callbacks</a>. You may keep the <code>descriptor</code> for use, such as a parameter handle, but the descriptor field should still be set to NULL.</li><li>Set the descriptor field to NULL.</li><li>Check for and manage any errors (see <a class="el" href="pgscriptingplugins.html#PlaybackErrorHandling">Playback error handling</a>.)</li><li>Update your parameters and show your dialog, depending on playInfo. See <a class="el" href="_p_i_actions_8h.html#dialogPlayEnum">Play Dialog Options</a>.</li></ol>
<h3><a class="anchor" name="PlaybackErrorHandling">
Playback error handling</a></h3>
Because a descriptor can be built by other software, don�t assume that your keys will come in order, be of the proper type, or all be present. This is only relevant for plug-ins using the Deprecated Standard Descriptor Suite, in which keys are retrieved in order from the descriptor using the <code>GetKey</code> function. For the Action Descriptor Suite, keys are retrieved in any order by simply requesting them by name, once you have verified the key exists in the descriptor by using the <code>HasKey</code> function.<h4><a class="anchor" name="CoercedParams">
Coerced Parameters</a></h4>
If a <code>Get</code> call is made for the wrong type, <code>paramErr</code> will be returned unless the type could be coerced, in which case the value will be returned with the <code>coercedParam</code> error.<p>
If an error occurs and not <code>plugInDialogSilent</code>, then the plug-in may:<ul>
<li>Present a dialog and return a positive error value, or</li><li>Return a negative error value and the host displays a standard message.</li></ul>
<h4><a class="anchor" name="StickyErrors">
Sticky Errors</a></h4>
Errors that occur in <code>Get</code> routines and <code>GetKeyProc</code> are sticky, meaning that an error keeps getting returned until another more drastic error supercedes it. This way the plug-in can check for any major errors after it has read all the data.<p>
<table border="1" 
 summary="Playback errors returned" cellspacing="3" cellpadding="3">
<caption align="bottom"><em>Playback errors returned</em></caption>
<tr>
<th>Name </th><th>Description </th></tr>
<tr>
<td><code>NULL</code> </td><td>No error. </td></tr>
<tr>
<td><code>coercedParam</code> </td><td>Coerced data to requested type. </td></tr>
<tr>
<td><code>paramErr</code> </td><td>Error with parameters passed or data <br>
 does not match requesting proc. </td></tr>
<tr>
<td><code>errWrongPlatformFilePath</code> </td><td>Mismatch between <code>typeAlias</code> (Macintosh) and <br>
 <code>typePath</code> (Windows) request. </td></tr>
</table>
<h4><a class="anchor" name="DescriptorKeyArray">
DescriptorKeyIDArray</a></h4>
When using the <a class="el" href="group___descriptor_suite.html">Deprecated Standard Descriptor Suite</a>, during the repeated calls to <code>GetKeyProc</code>, <code>DescriptorKeyIDArray</code>, passed to <a class="el" href="group___descriptor_suite.html#gcb0ff4c9e31f65b55d835806ff59a636">OpenReadDescriptorProc</a>, is updated automatically. As each key is found in <code>GetKeyProc</code>, the corresponding key in <code>descriptorKeyIDArray</code> is set to <code>typeNull='null'</code>. Keys still in the array after you�re done reading all the data indicate keys that were not passed in the descriptor and you will need to coerce them or request them from the user (if not <code>plugInDialogSilent</code>).<h2><a class="anchor" name="PGScriptingApplescriptCompatiblity">
AppleScript Compatibility</a></h2>
The Photoshop scripting system was made with AppleScript compatibility as one of its primary goals. This explains the reliance on some of the more (seemingly needless) complex structures such as the dictionary resource. The reliance on the dictionary resource, and the structure of the key name and ID pairs, maps directly to AppleScript. There are some important details to watch out for.<p>
AppleScript maintains a global name space, which means if your plug-in is going to be AppleScript compatible, your key name and ID pairs must be completely unique. For example, if you defined:<p>
<div class="fragment"><pre class="fragment">    <span class="stringliteral">"red"</span>,                  <span class="comment">// red property</span>
    myRed,                  <span class="comment">// my unique property ID for Red</span>
    typeFloat,              <span class="comment">// value type "float"</span>
    <span class="stringliteral">""</span>,                     <span class="comment">// no description</span>
    flagsSingleParameter    <span class="comment">// single parameter</span>

    <span class="stringliteral">"green"</span>,                <span class="comment">// green property</span>
    myGreen,                <span class="comment">// my unique property ID for Green</span>
    typeFloat,              <span class="comment">// value type "float"</span>
    <span class="stringliteral">""</span>,                     <span class="comment">// no description</span>
    flagsSingleParameter    <span class="comment">// single parameter</span>

    <span class="stringliteral">"blue"</span>,                 <span class="comment">// blue property</span>
    myBlue,                 <span class="comment">// my unique property ID for Blue</span>
    typeFloat,              <span class="comment">// value type "float"</span>
    <span class="stringliteral">""</span>,                     <span class="comment">// no description</span>
    flagsSingleParameter    <span class="comment">// single parameter</span>
</pre></div><p>
You would ruin "red", "green", and "blue" for anyone else who attempted to use it, as it would now map to your unique keys (or whoever got their dictionary registered before yours.) In this case, you must use unique textual names as well, such as: <div class="fragment"><pre class="fragment">    <span class="stringliteral">"AdobeSDK red"</span>,         <span class="comment">// unique red property name</span>
    myRed,                  <span class="comment">// my unique property ID for Red</span>
    typeFloat,              <span class="comment">// value type "float"</span>
    <span class="stringliteral">""</span>,                     <span class="comment">// no description</span>
    flagsSingleParameter    <span class="comment">// single parameter</span>
</pre></div><p>
In that case, future requests would take the form of: <div class="fragment"><pre class="fragment">tell <span class="stringliteral">"Adobe SDK dissolve"</span>
    set AdobeSDK red of AdobeSDK Dissolve to 65535, 0, 0
end tell
</pre></div><p>
This way is safe and makes sure you don�t conflict with anything else. When in doubt, make the name and ID unique, or use the predefined values. Those are always available and are mapped to your plug-in through your dictionary resource automatically.<h3><a class="anchor" name="PGScriptingRegistration">
Registration and Unique Name Spaces</a></h3>
When trying to determine unique key name and ID spaces, you must follow these rules:<ul>
<li>All ID�s starting with an uppercase letter are reserved by Adobe.</li><li>All ID�s that are all uppercase are reserved by Apple.</li><li>All ID�s that are all lowercase are reserved by Apple.</li><li>This leaves all ID�s that begin with a lowercase letter and have at least one uppercase letter for you and other plug-in developers.</li></ul>
<p>
Since the scripting system is based on unique IDs and AppleScript, and works the same between Mac OS and Windows, this means that if you wish to register a unique ID you must use the Apple filename ID registration web page, whether Windows or Mac OS based. The web page is at <a href="http://dev.info.apple.com/cftype/main.html.">http://dev.info.apple.com/cftype/main.html.</a><h4><a class="anchor" name="PGScriptingGoodWillFormat">
Common Adobe Plug-in ID Good Will Format</a></h4>
For all plug-in developers wishing to allocate a block of IDs (which is common to want to do, for sets of plug-ins needing unique variables, etc.) register your plug-in type as a variant, with the first three characters following the basic rules for ID creation, and a last character of "#". This registers all 255 permutations of your ID. For example,<p>
<ul>
<li><code>'sdK#'</code> reserves <code>sdKx</code>, where x is any character, allowing keys such as <code>'sdK*'</code>, <code>'sdK0'</code>, <code>'sdKA'</code>, or <code>'sdKz'</code>, and</li><li><code>'gAr#'</code> reserves <code>gArx</code>, where x is any character, allowing keys such as <code>'gAr$'</code>, <code>'gAr8'</code>, <code>'gArG'</code>, or <code>'gArr'</code>.</li></ul>
<p>
Remember, if you�re registering a block of name space, that the first three characters must follow the ID rules: they must start with a lowercase character, and at least one character must be uppercase.<p>
<dl class="note" compact><dt><b>Note:</b></dt><dd>This registration method is not supported by Apple. As a matter of fact, Apple explicitly states that one cannot reserve more than one ID at a time. If we all follow the same rule, however, it will work just fine until another solution becomes apparent.</dd></dl>
When you log onto the registration web page to check your unique ID, you must check for 'nam#' where nam is your three-digit ID. If you check and register any four digit ID, without searching for your three-digit ID + "#", then you will probably stomp someone else's name space.<p>
This name space registration method is only useful if we all agree do follow it.<h3><a class="anchor" name="PGScriptingIgnoringAppleScript">
Ignoring AppleScript</a></h3>
If you�ve decided that forward compatibility with future AppleScript features is not a major concern, you can disable any AppleScript-savvy features and make your plug-in only Photoshop-specific. By doing this, you may ignore any requirements for unique key name and ID pairs. To do this, add a unique ID string to your <code>HasTerminology</code> resource.<p>
For example, the following entry in the PiPL resource file ignores AppleScript: <div class="fragment"><pre class="fragment">        HasTerminology
        {
            plugInClassID,                  <span class="comment">// Class ID</span>
            plugInEventID,                  <span class="comment">// Event ID</span>
            ResourceID,                     <span class="comment">// AETE ID</span>
            <span class="comment">// Unique string or empty for AppleScript compliant:</span>
            <span class="stringliteral">"98b5a608-46ce-11d3-bd6b-0060b0a13dc4"</span>
        }
</pre></div><p>
But the following entry indicates the plug-in is AppleScript compatible: <div class="fragment"><pre class="fragment">        HasTerminology
        {
            plugInClassID,                  <span class="comment">// Class ID</span>
            plugInEventID,                  <span class="comment">// Event ID</span>
            ResourceID,                     <span class="comment">// AETE ID</span>
            <span class="comment">// Unique string or empty for AppleScript compliant:</span>
            <span class="stringliteral">""</span>
        }
</pre></div><p>
For more information, see <a class="el" href="group___pi_p_l_scripting_keys.html">Scripting-specific PiPL Properties</a>, and the <code><a class="el" href="struct_p_i_terminology.html">PITerminology</a></code> structure.<h3><a class="anchor" name="PGScriptingAppleEvents">
AppleEvents</a></h3>
In Photoshop 4.0 and 5.0, besides the standard AppleEvents, there is one additional AppleEvent call that is supported by the host: <code>do script</code>.<p>
You can call into Photoshop with the <code>do script</code> command to have it play any currently loaded script in the Actions palette.<p>
<div class="fragment"><pre class="fragment">tell application <span class="stringliteral">"Photoshop 4.0"</span>
    <span class="keywordflow">do</span> script <span class="stringliteral">"MyAction"</span>
end tell
</pre></div>
<!-- Begin Footer -->
</td>
<td width="20">&nbsp;&nbsp;</td>
</table>

<div id="footerrow"><!--give footer 25px of white above--></div>
<div id="footer" title="footer: links to copyright and other legal information">
<p><a href="licenses.html" class="el">&copy; 2023 Adobe</a></p>
<a title="Terms of Use" href="http://www.adobe.com/misc/copyright.html">Terms of Use - </a>
<a title="Privacy Policy" href="http://www.adobe.com/misc/privacy.html">Privacy Policy - </a>
<a href="http://access.adobe.com">Accessibility - </a>
<a title="Avoid software piracy" href="http://www.adobe.com/aboutadobe/antipiracy/main.html">Avoid software piracy - </a>
<a title="Permissions and trademarks" href="http://www.adobe.com/misc/agreement.html">Permissions and trademarks - </a>
<a title="Product License Agreements" href="http://www.adobe.com/products/eulas/main.html">Product License Agreements</a></div>
<p/>
</body>
</html>
